# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ddfb-KrlDnUlD7xrzjfXE8vkhw03OnsP
"""

import gradio as gr
import pandas as pd
import joblib
from pathlib import Path


# Load the model
loaded_data = joblib.load('Saved_models/Selected_customer_churn_model.pkl')
model = loaded_data["model"]

# Prediction function
def predict_churn(StreamingMovies, Contract, MultipleLines, InternetService, DeviceProtection):
    try:
        input_df = pd.DataFrame([{
            'StreamingMovies': StreamingMovies,
            'Contract': Contract,
            'MultipleLines': MultipleLines,
            'InternetService': InternetService,
            'DeviceProtection': DeviceProtection
        }])

        prob = model.predict_proba(input_df)[0][1]
        pred = model.predict(input_df)[0]

        return f"Prediction: {'Churn' if pred == 1 else 'No Churn'} (Probability: {prob:.2f})"
    except Exception as e:
        return f"⚠️ Error: {str(e)}"

# Define inputs for the UI
inputs = [
    gr.Radio(["No", "Yes"], label="Streaming Movies"),
    gr.Radio(["Month-to-month", "One year", "Two year"], label="Contract"),
    gr.Radio(["No", "Yes", "No phone service"], label="Multiple Lines"),
    gr.Radio(["DSL", "Fiber optic", "No"], label="Internet Service"),
    gr.Radio(["No", "Yes", "No internet service"], label="Device Protection")
]

# Output
output = gr.Textbox(label="Churn Prediction")

# Interface
app = gr.Interface(
    fn=predict_churn,
    inputs=inputs,
    outputs=output,
    title="Customer Churn Prediction",
    description="Enter customer service details to predict churn probability."
)

# Launch in notebook
app.launch(share=True)  # use share=True if you want a public link (e.g., for demo)

